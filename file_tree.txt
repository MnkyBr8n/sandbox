sandbox/
├── README.md
├── requirements.txt
├── INSTALL.md
├── docker-compose.yml
├── .dockerignore
│
├── app/
│   ├── __init__.py
│   ├── main.py                           # Orchestration: startup, process_project, multi-parser pipeline
│   │
│   ├── config/
│   │   ├── __init__.py
│   │   └── settings.py                   # Pydantic settings with ParserLimits, LOC thresholds
│   │
│   ├── ingest/
│   │   ├── __init__.py
│   │   ├── local_loader.py               # Ingest local directories
│   │   ├── github_cloner.py              # Clone GitHub repos via git
│   │   └── file_router.py                # Route files to multiple parsers
│   │
│   ├── parsers/
│   │   ├── __init__.py
│   │   ├── tree_sitter_parser.py         # Code structure extraction (14 languages)
│   │   ├── semgrep_parser.py             # Security and quality scanning
│   │   ├── text_extractor.py             # Document text extraction
│   │   └── csv_parser.py                 # CSV table preservation
│   │
│   ├── extraction/
│   │   ├── __init__.py
│   │   ├── field_mapper.py               # Categorize into 12 snapshot types
│   │   └── snapshot_builder.py           # Build categorized snapshots
│   │
│   ├── storage/
│   │   ├── __init__.py
│   │   ├── db.py                         # SQLAlchemy engine
│   │   └── snapshot_repo.py              # PostgreSQL persistence
│   │
│   ├── security/
│   │   ├── __init__.py
│   │   ├── network_policy.py             # Domain allowlist
│   │   └── sandbox_limits.py             # File/repo limits
│   │
│   └── logging/
│       ├── __init__.py
│       └── logger.py                     # Structured logging
│
├── schemas/
│   ├── master_notebook_v2.yaml           # 12 snapshot categories
│   └── snapshot_templates.json           # Category templates
│
├── data/
│   ├── uploads/
│   ├── repos/
│   └── projects/{project_id}/
│       └── project_manifest.json
│
└── docker/
    └── Dockerfile

## Database Schema

snapshot_notebooks
├── snapshot_id (UUID PRIMARY KEY)
├── project_id (TEXT NOT NULL)
├── snapshot_type (TEXT NOT NULL)         # 1 of 12 categories
├── source_file (TEXT NOT NULL)
├── field_values (JSONB NOT NULL)
├── created_at, updated_at
└── UNIQUE(project_id, source_file, snapshot_type)

## 12 Snapshot Categories

Code (tree_sitter):
1. file_metadata  2. imports  3. exports  4. functions
5. classes  6. connections  7. repo_metadata

Security/Quality (semgrep):
8. security  9. quality

Documents (text_extractor):
10. doc_metadata  11. doc_content  12. doc_analysis

## Multi-Parser Routing

Code → tree_sitter + semgrep
Text → text_extractor
CSV  → csv_parser

## File Categorization

< 1500 LOC: normal
1500-3999: large
4000-4999: potential_god
≥ 5000: rejected
